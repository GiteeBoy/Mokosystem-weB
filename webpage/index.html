<!doctype html>
<html>
	<head>
		<title>
			CryptoCowboy AutoTrader
		</title>

		<style>
			* { margin: 0; padding: 0; box-sizing: border-box; }
			body { font: 13px Helvetica, Arial; font-weight: bold; }
			h1 {font-size:30px;width:500px;color:#666;margin:0 auto 20px auto;}
			form { background: #000; padding: 3px; position: fixed; bottom: 0; width: 100%; }
			form input { border: 0; padding: 10px; width: 90%; margin-right: .5%; }
			form button { width: 9%; background: rgb(130, 224, 255); border: none; padding: 10px; }
			#messages { list-style-type: none; margin: 0; padding: 0; }
			#messages li { padding: 5px 10px; }
			#messages li:nth-child(odd) { background: #eee; }
		</style>
	</head>
	
	<script src="/socket.io/socket.io.js"></script>
	<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
			<script src="https://d3dy5gmtp8yhk7.cloudfront.net/2.1/pusher.min.js"></script>

	<!--
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	-->
	
	<script>	
		$(document).ready(function()
		{
			var pricePerShare = 0;
			var marketValue = 0;
			var netWorth = 0;
			var USD = 0;
			var XRP = 0;
			var socket;
			var totalTransactions = 0;
			var fixedPoint = 0;
			var hours = 0;
			var reserveMultiplier = 0;
			var reserve = 0.00;
			var reserveXRP = 0.00;
						
			var dayTradeGains = 0;
			
			var BTCPrice = 0;

			var orderPriceSell = 0.00;
			var orderPricebuy = 0.00;
			
			var openOrderRange = 0.00;
			var currentPricePercentage = 0.00;
			var totalUSD = 0.00;
			var totalXRP = 0.00;
			var totalLiquid = 0.00;
			var totalReserve = 0.00;
						
			var APR = 0.00;
			var dayTradePercent = 0;

			//	Socket IO
			$(function () 
			{
				socket = io();
				
				$('form').submit(function()
				{
					if($('#textBox').val() == "teslaOnMoon")
					{
						//$( "#investmentDiv" ).show();
					}
					else
					{
						socket.emit('inputReceived', $('#textBox').val());	//	Emit textbox
					}
					
					$('#textBox').val('');	//	Clear Text
					
					return false;
				});
				
				socket.on('emit', function(msg)
				{
					if(msg == "We sold shares!")
					{
						$('#messages').append($('<li style="color:green;">').text(msg));
					}
					else if(msg == "We bought shares!")
					{
						$('#messages').append($('<li style="color:red;">').text(msg));
					}
					else if(msg.charAt(0) == '[')
					{
						$('#messages').append($('<li style="color:grey;">').text(msg));
					}
					else if(msg == "We gained $0 on that trade.")
					{
						//	Do nothing... This sucks.
					}
					else
					{
						$('#messages').append($('<li>').text(msg));
					}
					
					var wtf = $('#messagesListDiv');
					var height = wtf[0].scrollHeight;
					wtf.scrollTop(height);
				});
				
				socket.on('privateMessage', function(msg)
				{
					$('#messages').append($('<li>').text(msg));
					
					var wtf = $('#messagesListDiv');
					var height = wtf[0].scrollHeight;
					wtf.scrollTop(height);
				});
				
				socket.on('USD', function(msg)
				{
					USD = msg;
					USD = parseFloat(USD).toFixed(2);
					$('#cashDiv').text("$" + USD);
					
					
					
					//Color reinvestment mult
					let reinvestmentPrice = 0.00;
					reinvestmentPrice = marketValue * reserveMultiplier;
					
					let reinvestmentPercentage = 0.00;
					reinvestmentPercentage = (USD / reinvestmentPrice);
					reinvestmentPercentage = (reinvestmentPercentage * 200.00);
					reinvestmentPercentage = (reinvestmentPercentage - 100.00);
					
					let color = 0.00;
					if(parseFloat(reinvestmentPercentage) > 0.00)
					{
						
						color = Math.floor((parseFloat(reinvestmentPercentage) * 2.4));
						color = rgbToHex(color);
						color = "#00" + color + "00";
						$("#reserveMultiplierDiv").css('color', (color));
						
						
					}
					else if(parseFloat(reinvestmentPercentage) < 0.00)
					{
						color = Math.floor(-parseFloat(reinvestmentPercentage) * 2.4);
						
						//$('#messages').append($('<li>').text(currentPricePercentage));
						//$('#messages').append($('<li>').text(-parseFloat(currentPricePercentage)));

						//$('#messages').append($('<li>').text(color));
						
						color = rgbToHex(color);
						color = "#" + color + "0000";
						
						
						//$('#messages').append($('<li>').text(color));
						
						$("#cashDiv").css('color', (color));
					}
					else
					{
						$("#cashDiv").css('color', 'black');
					}
					
					
				});
				
				socket.on('XRP', function(msg)
				{
					XRP = msg;
					XRP = parseFloat(XRP).toFixed(2);
					$('#sharesDiv').text("x" + XRP);
				});
				
				socket.on('reserve', function(msg)
				{
					reserve = parseFloat(msg).toFixed(2);
					$('#reserveDiv').text("$" + reserve);
				});
				
				socket.on('reserveXRP', function(msg)
				{
					reserveXRP = parseFloat(msg).toFixed(2);
					$('#reserveXRPDiv').text("x" + reserveXRP);
				});
				
				socket.on('fixedPoint', function(msg)
				{
					fixedPoint = msg;
					$('#fixedPointDiv').text(parseFloat(msg).toFixed(2));
				});
				
				socket.on('range', function(msg)
				{
					$('#rangeDiv').text(parseFloat(msg).toFixed(2));
					$('#rangePercentageDiv').text(((parseFloat(msg) * 100.00) / parseFloat(marketValue)).toFixed(2) + "%");
				});

				socket.on('salesMultiplier', function(msg)
				{
					$('#salesMultiplierDiv').text(parseFloat(msg).toFixed(4));
